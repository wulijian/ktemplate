<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Ktemplate by wulijian</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>Ktemplate</h1>
          <h2>简单，高效，支持预编译，支持sourcemap的js模版</h2>
        </header>

        <section id="downloads" class="clearfix">
          <a href="https://github.com/wulijian/ktemplate/zipball/master" id="download-zip" class="button"><span>Download .zip</span></a>
          <a href="https://github.com/wulijian/ktemplate/tarball/master" id="download-tar-gz" class="button"><span>Download .tar.gz</span></a>
          <a href="https://github.com/wulijian/ktemplate" id="view-on-github" class="button"><span>View on GitHub</span></a>
        </section>

        <hr>

        <section id="main_content">
          <h2>
<a name="%E7%AE%80%E4%BB%8B" class="anchor" href="#%E7%AE%80%E4%BB%8B"><span class="octicon octicon-link"></span></a>简介</h2>

<p>ktemplate 是基于 nodejs 的 js 模版引擎。</p>

<p>它的语法简单，学习成本低，支持预编译，支持子模板，还支持 sourcemap 调试。</p>

<p>它没有重新定义语法，而是采用了标准的js代码加html代码。</p>

<h3>
<a name="%E5%8E%9F%E7%90%86" class="anchor" href="#%E5%8E%9F%E7%90%86"><span class="octicon octicon-link"></span></a>原理</h3>

<p>使用 ktemplate 语法的模板，会通过模板引擎的编译，转变成一个js函数，函数包含一个参数 _data。调用该函数，传入数据，返回的是拼凑好的html代码。</p>

<p>例如：</p>

<div class="highlight highlight-HTML"><pre><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"test"</span><span class="nt">&gt;</span>
    hi, <span class="err">&lt;</span>%= hi %&gt;<span class="nt">&lt;br&gt;</span>
    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"javascript:void(0)"</span><span class="nt">&gt;</span><span class="err">&lt;</span>%= hello %&gt;<span class="nt">&lt;/a&gt;</span>
<span class="nt">&lt;/div&gt;</span>

</pre></div>

<p>经过编译，会生成方法：</p>

<div class="highlight highlight-Javascript"><pre><span class="kd">function</span> <span class="nx">anonymous</span><span class="p">(</span><span class="nx">_data</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">htmlCode</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span>
    <span class="kd">with</span> <span class="p">(</span><span class="nx">_data</span> <span class="o">||</span> <span class="p">{})</span> <span class="p">{</span>
        <span class="nx">htmlCode</span> <span class="o">+=</span> <span class="s1">'&lt;div id="test"&gt;\r\n    hi, '</span><span class="p">;</span>
        <span class="nx">htmlCode</span> <span class="o">+=</span> <span class="nx">hi</span><span class="p">;</span>
        <span class="nx">htmlCode</span> <span class="o">+=</span> <span class="s1">'&lt;br&gt;\r\n    &lt;a href="javascript:void(0)"&gt;'</span><span class="p">;</span>
        <span class="nx">htmlCode</span> <span class="o">+=</span> <span class="nx">hello</span><span class="p">;</span>
        <span class="nx">htmlCode</span> <span class="o">+=</span> <span class="s2">"&lt;/a&gt;\r\n&lt;/div&gt;"</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">htmlCode</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<p>所以，最终使用的只是js方法，性能问题不需要考虑。</p>

<h3>
<a name="%E8%AF%AD%E6%B3%95" class="anchor" href="#%E8%AF%AD%E6%B3%95"><span class="octicon octicon-link"></span></a>语法</h3>

<h4>
<a name="%E8%BE%93%E5%87%BA" class="anchor" href="#%E8%BE%93%E5%87%BA"><span class="octicon octicon-link"></span></a>输出</h4>

<p>输出标示符会将&lt;%= %&gt;内的正规的js的值，输出到其所在的位置。</p>

<div class="highlight highlight-HTML"><pre><span class="nt">&lt;div&gt;</span>
<span class="err">&lt;</span>%= _data.content %&gt;
<span class="nt">&lt;/div&gt;</span>
</pre></div>

<p>如果以上 _data.content = "hello ktemplate"; 那么，最终的结果将是：</p>

<div class="highlight highlight-HTML"><pre><span class="nt">&lt;div&gt;</span>
hello ktemplate
<span class="nt">&lt;/div&gt;</span>
</pre></div>

<h4>
<a name="js%E8%AF%AD%E5%8F%A5" class="anchor" href="#js%E8%AF%AD%E5%8F%A5"><span class="octicon octicon-link"></span></a>js语句</h4>

<p>&lt;% %&gt;内可以写任何符合的 js 语句，例如：</p>

<div class="highlight highlight-HTML"><pre><span class="err">&lt;</span>%var a =3; %&gt;
<span class="err">&lt;</span>%var b=4; %&gt;
<span class="err">&lt;</span>%= a+b %&gt;
</pre></div>

<p>最终会输出7.</p>

<p>需要注意的是，每行必须有闭合符号 %&gt;。</p>

<h4>
<a name="%E5%AD%90%E6%A8%A1%E6%9D%BF" class="anchor" href="#%E5%AD%90%E6%A8%A1%E6%9D%BF"><span class="octicon octicon-link"></span></a>子模板</h4>

<p>ktemplate 比其他模板还有一个优势，就是支持子模板。 子模板可以保证一个逻辑相关的模板不会太大，以至于很难维护。语法是：&lt;%== url(data) %&gt;。</p>

<p>url 代表子模板的相对地址，data是指传给子模板内的数据。</p>

<p>例如，调用模板的时候，数据如下：</p>

<div class="highlight highlight-javascript"><pre><span class="p">{</span>
 <span class="s2">"head"</span><span class="o">:</span><span class="s2">"这是一个实例"</span><span class="p">,</span>
  <span class="s2">"content"</span><span class="o">:</span><span class="p">{</span>
     <span class="s2">"name"</span><span class="o">:</span><span class="s2">"子模板的数据"</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p>你建了两个ktemplate模板
a.html</p>

<div class="highlight highlight-HTML"><pre><span class="err">&lt;</span>%= _data.content.name %&gt;
</pre></div>

<p>b.html</p>

<div class="highlight highlight-HTML"><pre><span class="err">&lt;</span>%= head %&gt;
<span class="err">&lt;</span>%== ./a(_data.content) %&gt;
</pre></div>

<p>其中，b.html 中引用了 a.html 模板，并且将数据的 content属性传给了子模板。最终渲染结果：</p>

<div class="highlight highlight-HTML"><pre>这是一个实例
子模板的数据
</pre></div>

<h3>
<a name="%E6%95%B0%E6%8D%AE" class="anchor" href="#%E6%95%B0%E6%8D%AE"><span class="octicon octicon-link"></span></a>数据</h3>

<p>在 ktemplate 中，为了在写模板的时候省去写 _data 等参数的麻烦，在编译过程中，加入了with(_data){...}。优点是可以在套模板的时候省略_data，缺点是with会在运行时添加一层作用域。</p>

<h2>
<a name="contributors" class="anchor" href="#contributors"><span class="octicon octicon-link"></span></a>Contributors</h2>

<p>authors  : KnightWu</p>
        </section>

        <footer>
          Ktemplate is maintained by <a href="https://github.com/wulijian">wulijian</a><br>
          This page was generated by <a href="http://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>

        
      </div>
    </div>
  </body>
</html>